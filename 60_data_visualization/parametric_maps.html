
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Parametric maps &#8212; Bio-image Analysis Notebooks</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantitative maps from neighbor statistics" href="quantitative_neighbor_maps.html" />
    <link rel="prev" title="Overlay texts on images" href="overlay_text_on_image.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Bio-image Analysis Notebooks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Bio-image Analysis Notebooks
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01_introduction/trailer.html">
   Trailer: Bio-image Analysis with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_introduction/readme.html">
   Setting up your computer
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_python_basics/readme.html">
   Python basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/01_our_first_juptyer_notebook.html">
     Python code in Jupyter notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/02_Math_in_python.html">
     Basic math in python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/03_Dont_try_this_at_home.html">
     Pitfalls when working with Jupyter notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/04_Basic_types.html">
     Basic types in python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/05_lists_tuples.html">
     Lists and tuples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/05a_cropping_lists.html">
     Cropping lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/05b_sorting_lists.html">
     Sorting lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/05c_masking.html">
     Masking numpy arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/06_Dictionaries_and_tables.html">
     Dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/07_Conditions.html">
     Conditions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/08_loops.html">
     Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/09_custom_functions.html">
     Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03_advanced_python/readme.html">
   Advanced python programming
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_advanced_python/custom_libraries.html">
     Custom libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_advanced_python/functional_parameters.html">
     Functional parameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_advanced_python/napari_workflows.html">
     Workflows in napari
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_advanced_python/parallelization.html">
     Parallelization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../12_image_analysis_basics/readme.html">
   Image analysis basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_image_analysis_basics/01_Introduction_to_image_processing.html">
     Introduction to image processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_image_analysis_basics/02_Working_with_images.html">
     Working with images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_image_analysis_basics/03_Cropping_images.html">
     Cropping images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_image_analysis_basics/04_multi_channel_image_data.html">
     Multi-channel image data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_image_analysis_basics/image_file_formats.html">
     Image file formats
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../15_gpu_acceleration/readme.html">
   GPU accelerated image processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../15_gpu_acceleration/clesperanto.html">
     clEsperanto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15_gpu_acceleration/why_GPU_acceleration.html">
     Why GPU-acceleration makes sense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15_gpu_acceleration/cupy.html">
     GPU-accelerated image processing using CUPY and CUCIM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15_gpu_acceleration/memory_management.html">
     Tracing memory consumption
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15_gpu_acceleration/further_reading.html">
     Further reading
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../16_3d_image_visualization/readme.html">
   Image visualization in 3D
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../16_3d_image_visualization/10_nd_image_data.html">
     Multidimensional image stacks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../16_3d_image_visualization/inspecting_3d_images.html">
     Inspecting 3D image data with pyclesperanto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../16_3d_image_visualization/05_napari.html">
     Interactive image visualization with napari
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../18_image_filtering/readme.html">
   Image filtering
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/01_Filtering.html">
     Filtering images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/convolution.html">
     Convolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/02_noise_removal.html">
     Noise removal filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/03_background_removal.html">
     Background removal filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/edge_detection_and_enhancement.html">
     Edge detection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/simpleitk.html">
     Processing images using SimpleITK
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../18a_deconvolution/readme.html">
   Image deconvolution
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../18a_deconvolution/introduction_deconvolution.html">
     An introduction to image deconvolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18a_deconvolution/extract_psf.html">
     Determining the point-spread-function from a bead image by averaging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18a_deconvolution/richardson_lucy_deconvolution.html">
     Richardson-Lucy-Deconvolution on OpenCL-compatible GPUs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../19_spatial_transforms/readme.html">
   Spatial transforms
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/coordinate_systems.html">
     Coordinate systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/cropping.html">
     Slicing and cropping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/affine_transforms_scikit_image.html">
     Affine transforms using scikit-image
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/affine_transforms_scipy.html">
     Affine transforms using Scipy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/affine_transforms_cupy.html">
     Affine transforms using cupy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/affine_transforms_clesperanto.html">
     Affine transforms using clesperanto
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../20_image_segmentation/readme.html">
   Image segmentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/06_Introduction_to_image_segmentation.html">
     Image segmentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/07_Thresholding.html">
     Thresholding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/08_binary_mask_refinement.html">
     Binary mask refinement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/08a_split_touching_objects.html">
     Split touching objects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/09_connected_component_labeling.html">
     Label images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/09a_gauss_otsu_labeling.html">
     Gauss-Otsu-labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/10_touching_objects_labeling.html">
     Touching objects labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/11_voronoi_otsu_labeling.html">
     Voronoi-Otsu-labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/12_open_close_labels.html">
     Label image refinement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/14_remove_labels_on_image_edges.html">
     Remove labels on image edges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/15_sequential_labeling.html">
     Sequential object (re-)labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/segmentation_2d_membranes.html">
     Seeded watershed for membrane-based cell segmentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/refine_cell_segmentation.html">
     Post-processing for membrane-based cell segmentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/Segmentation_3D.html">
     3D Image Segmentation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../20a_pixel_classification/readme.html">
   Machine learning for image segmentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/scikit_learn_random_forest_pixel_classifier.html">
     Pixel classification using Scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/apoc_object_segmenter.html">
     Object segmentation on OpenCL-compatible GPUs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/apoc_pixel_classifier.html">
     Pixel classification on OpenCL-compatible GPUs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/mutlichannel_images.html">
     Pixel classification in multi-channel images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/apoc_probability_mapper.html">
     Probability maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/apoc_train_on_folders.html">
     Training pixel classifiers from folders of images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/feature_stacks.html">
     Generating feature stacks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/selecting_features.html">
     Selecting features
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../21_segmentation_comparison/readme.html">
   Comparing segmentation algorithms
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../21_segmentation_comparison/scenario_otsu_segmentation.html">
     Scenario: Comparing different implementations of the same thresholding algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../21_segmentation_comparison/visual_comparison.html">
     Visual labeling comparison
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../21_segmentation_comparison/quantiative_comparison.html">
     Quantitative labeling comparison
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../22_feature_extraction/readme.html">
   Feature extraction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/quantitative_measurements.html">
     Quantitative image analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/count_blobs.html">
     Counting bright objects in images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/statistics_with_pyclesperanto.html">
     Basic statistics with pyclesperanto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/statistics_with_simpleitk.html">
     Statistics using SimpleITK
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/comparison_of_measurements_from_different_libraries.html">
     Comparison of measurements from different libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/measure_intensity_on_label_edges.html">
     Measuring intensity on label borders
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/shape_descriptors_based_on_neighborhood_graphs.html">
     Shape descriptors based on neighborhood graphs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../25_neighborhood_relationships_between_cells/readme.html">
   Neighborhood analysis in tissues
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/01_neighborhood_definitions.html">
     Neighborhood definitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/05_count_touching_neighbors.html">
     Count touching neighbors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/06_mesh_with_distances.html">
     Draw distance-meshes between neighbors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/distance_to_other_labels.html">
     Measure the distance to cells in another label image
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/other_proximal_labels_count.html">
     Count proximal labels in an other label image
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/neighbor_meshes_in_3d.html">
     Neighbor meshes in three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/label_neighbor_filters.html">
     Label neighbor filters
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../27_cell_classification/readme.html">
   Cell classification
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../27_cell_classification/apoc_object_classifier.html">
     Object classification on OpenCL-compatible GPUs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../27_cell_classification/forest_statistics.html">
     Random forest decision making statistics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../28_colocalization/readme.html">
   Colocalization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../28_colocalization/counting_nuclei_multichannel.html">
     Counting nuclei according to expression in multiple channels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../28_colocalization/differentiate_nuclei_intensity.html">
     Differentiating nuclei according to signal intensity
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../31_graphical_user_interfaces/readme.html">
   Graphical user interfaces
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../31_graphical_user_interfaces/napari.html">
     Interactive image visualization with napari
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31_graphical_user_interfaces/napari_magicgui.html">
     Interactive parameter tuning with napari and magicgui
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31_graphical_user_interfaces/napari-skimage-regionprops.html">
     Visualizing region properties in napari
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31_graphical_user_interfaces/napari_dask.html">
     Tribolium embryo morphometry over time in Napari
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31_graphical_user_interfaces/napari_crop.html">
     Interactive cropping with napari
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../32_tiled_image_processing/readme.html">
   Tiled image processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_nuclei_counting_quick.html">
     Tiled image processing, a quick run-through
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiling_images_naive_approach.html">
     Tiling images - the naive approach
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiling_images_with_overlap.html">
     Tiling images with overlap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_connected_component_labeling.html">
     Connected component labeling in tiles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_object_measurements.html">
     Measurements in objects in tiled images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_image_file_formats_zarr.html">
     Tiled image file formats: zarr
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_area_mapping.html">
     Map area of objects in tiles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_nuclei_counting.html">
     Counting nuclei in tiles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../33_batch_processing/readme.html">
   Batch processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../33_batch_processing/12_process_folders.html">
     How process files in a folder
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../40_tabular_data_wrangling/readme.html">
   Tabular data wrangling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../40_tabular_data_wrangling/introduction_dataframes.html">
     Introduction to working with DataFrames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../40_tabular_data_wrangling/explore_dataset.html">
     Exploring tabular data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../40_tabular_data_wrangling/descriptive_statistics.html">
     Basic descriptive statistcs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../40_tabular_data_wrangling/handling_NaNs.html">
     Handling NaN values
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../40_tabular_data_wrangling/pivot_tables.html">
     Pivot tables
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../51_plotting/readme.html">
   Plotting
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../51_plotting/plotting_seaborn.html">
     Plotting using seaborn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../51_plotting/plotting_matplotlib.html">
     Plotting with Matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../51_plotting/bland_altman_analysis.html">
     Bland-Altman plots
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="readme.html">
   Data visualization
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="overlay_text_on_image.html">
     Overlay texts on images
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Parametric maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="quantitative_neighbor_maps.html">
     Quantitative maps from neighbor statistics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_introduction/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../imprint.html">
   Imprint
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/60_data_visualization/parametric_maps.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/haesleinhuepf/BioImageAnalysisNotebooks"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/haesleinhuepf/BioImageAnalysisNotebooks/issues/new?title=Issue%20on%20page%20%2F60_data_visualization/parametric_maps.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/haesleinhuepf/BioImageAnalysisNotebooks/main?urlpath=tree/docs/60_data_visualization/parametric_maps.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametric-maps-using-scikit-image">
   Parametric maps using scikit-image
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#area-map">
   Area map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametric-maps-in-pyclesperanto">
   Parametric maps in pyclesperanto
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pixel-count-map">
   Pixel count map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametric-maps-using-simpleitk-based-measurements">
   Parametric maps using SimpleITK-based measurements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#number-of-pixels-map">
   Number of pixels map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extension-ratio-map">
   Extension ratio map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-minimum-maximum-standard-deviation-intensity-map">
   Mean / minimum / maximum / standard-deviation intensity map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aspect-ratio-map">
   Aspect ratio map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#elongation-map">
   Elongation map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extent-map">
   Extent map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feret-diameter-map">
   Feret diameter map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orientation-map">
   Orientation map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perimeter-map">
   Perimeter map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solidity-map">
   Solidity map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Elongation map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flatness-map">
   Flatness map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#roundness-map">
   Roundness map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Perimeter map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quality-assurance">
   Quality assurance
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Parametric maps</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametric-maps-using-scikit-image">
   Parametric maps using scikit-image
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#area-map">
   Area map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametric-maps-in-pyclesperanto">
   Parametric maps in pyclesperanto
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pixel-count-map">
   Pixel count map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametric-maps-using-simpleitk-based-measurements">
   Parametric maps using SimpleITK-based measurements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#number-of-pixels-map">
   Number of pixels map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extension-ratio-map">
   Extension ratio map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-minimum-maximum-standard-deviation-intensity-map">
   Mean / minimum / maximum / standard-deviation intensity map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aspect-ratio-map">
   Aspect ratio map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#elongation-map">
   Elongation map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extent-map">
   Extent map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feret-diameter-map">
   Feret diameter map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orientation-map">
   Orientation map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perimeter-map">
   Perimeter map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solidity-map">
   Solidity map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Elongation map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flatness-map">
   Flatness map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#roundness-map">
   Roundness map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Perimeter map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quality-assurance">
   Quality assurance
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="parametric-maps">
<span id="data-visualization-parametric-maps"></span><h1>Parametric maps<a class="headerlink" href="#parametric-maps" title="Permalink to this headline">¶</a></h1>
<p>This notebook demonstrates how parametric maps can be made. In such parametric images, pixel intensity corresponds to  measurements of the objects, for example area.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyclesperanto_prototype</span> <span class="k">as</span> <span class="nn">cle</span>
<span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span><span class="p">,</span> <span class="n">imsave</span>
<span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">regionprops</span><span class="p">,</span> <span class="n">regionprops_table</span>
<span class="kn">from</span> <span class="nn">skimage.util</span> <span class="kn">import</span> <span class="n">map_array</span>
<span class="kn">from</span> <span class="nn">napari_simpleitk_image_processing</span> <span class="kn">import</span> <span class="n">label_statistics</span>
</pre></div>
</div>
</div>
</div>
<p>Starting point for drawing parametric maps is always a label image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binary</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">artificial_objects_2d</span><span class="p">()</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">voronoi_otsu_labeling</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">spot_sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_3_0.png" src="../_images/parametric_maps_3_0.png" />
</div>
</div>
<div class="section" id="parametric-maps-using-scikit-image">
<h2>Parametric maps using scikit-image<a class="headerlink" href="#parametric-maps-using-scikit-image" title="Permalink to this headline">¶</a></h2>
<p>You can also compute your own measurement for each object and then visualize it in a parametric map image. Consider using <a class="reference external" href="https://scikit-image.org/docs/dev/api/skimage.measure.html#skimage.measure.regionprops">scikit-image’s <code class="docutils literal notranslate"><span class="pre">regionprops()</span></code></a> for computing the measurements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">statistics_table</span> <span class="o">=</span> <span class="n">regionprops_table</span><span class="p">(</span><span class="n">cle</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">properties</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="area-map">
<h2>Area map<a class="headerlink" href="#area-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">remapped</span> <span class="o">=</span> <span class="n">map_array</span><span class="p">(</span>
        <span class="n">cle</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span>
        <span class="n">statistics_table</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span>
        <span class="n">statistics_table</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">],</span>
        <span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">remapped</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_7_0.png" src="../_images/parametric_maps_7_0.png" />
</div>
</div>
</div>
<div class="section" id="parametric-maps-in-pyclesperanto">
<h2>Parametric maps in pyclesperanto<a class="headerlink" href="#parametric-maps-in-pyclesperanto" title="Permalink to this headline">¶</a></h2>
<p>Alternatively, we can use the function <code class="docutils literal notranslate"><span class="pre">cle.replace_intensities</span></code> for making these parametric maps. It expects a label image and a list of measurements ordered by label, starting with a measurement corresponding to background (index 0). In the list of measurements, no label should be missing. Consider to <a class="reference internal" href="../20_image_segmentation/15_sequential_labeling.html#image-segmentation-relabel-sequential"><span class="std std-ref">relabel the label image sequentially</span></a> if necessary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">statistics</span> <span class="o">=</span> <span class="n">regionprops</span><span class="p">(</span><span class="n">cle</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">area</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">statistics</span><span class="p">]</span>

<span class="n">area_map2</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">area</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">area_map2</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_11_0.png" src="../_images/parametric_maps_11_0.png" />
</div>
</div>
</div>
<div class="section" id="pixel-count-map">
<h2>Pixel count map<a class="headerlink" href="#pixel-count-map" title="Permalink to this headline">¶</a></h2>
<p>pyclesperanto comes with some maps built-in. For example the pixel count map derived from a label image expresses area or volume of objects in colour.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pixel_count_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">label_pixel_count_map</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pixel_count_map</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/haase/code/pyclesperanto_prototype/pyclesperanto_prototype/_tier9/_statistics_of_labelled_pixels.py:283: RuntimeWarning: invalid value encountered in true_divide
  region_props[&#39;mean_max_distance_to_centroid_ratio&#39;] = region_props[&#39;max_distance_to_centroid&#39;] / region_props[
/Users/haase/code/pyclesperanto_prototype/pyclesperanto_prototype/_tier9/_statistics_of_labelled_pixels.py:285: RuntimeWarning: invalid value encountered in true_divide
  region_props[&#39;mean_max_distance_to_mass_center_ratio&#39;] = region_props[&#39;max_distance_to_mass_center&#39;] / region_props[
</pre></div>
</div>
<img alt="../_images/parametric_maps_13_1.png" src="../_images/parametric_maps_13_1.png" />
</div>
</div>
</div>
<div class="section" id="parametric-maps-using-simpleitk-based-measurements">
<h2>Parametric maps using SimpleITK-based measurements<a class="headerlink" href="#parametric-maps-using-simpleitk-based-measurements" title="Permalink to this headline">¶</a></h2>
<p>Furthermore, also <a class="reference external" href="https://simpleitk.readthedocs.io/">SimpleITK</a> comes with quantitative measurements for labeled images. For convenience reasons, we will use the scriptable napari plugin <a class="reference external" href="https://github.com/haesleinhuepf/napari-simpleitk-image-processing">napari-simpleitk-image-processing</a> for deriving measurements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">statistics_sitk</span> <span class="o">=</span> <span class="n">label_statistics</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">perimeter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">statistics_sitk</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;label&#39;, &#39;elongation&#39;, &#39;feret_diameter&#39;, &#39;flatness&#39;, &#39;roundness&#39;, &#39;equivalent_ellipsoid_diameter_0&#39;, &#39;equivalent_ellipsoid_diameter_1&#39;, &#39;equivalent_spherical_perimeter&#39;, &#39;equivalent_spherical_radius&#39;, &#39;number_of_pixels&#39;, &#39;number_of_pixels_on_border&#39;, &#39;perimeter&#39;, &#39;perimeter_on_border&#39;, &#39;perimeter_on_border_ratio&#39;])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="number-of-pixels-map">
<h2>Number of pixels map<a class="headerlink" href="#number-of-pixels-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">number_of_pixels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">statistics_sitk</span><span class="p">[</span><span class="s1">&#39;number_of_pixels&#39;</span><span class="p">]</span>

<span class="n">number_of_pixels_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">number_of_pixels</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">number_of_pixels_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_17_0.png" src="../_images/parametric_maps_17_0.png" />
</div>
</div>
</div>
<div class="section" id="extension-ratio-map">
<h2>Extension ratio map<a class="headerlink" href="#extension-ratio-map" title="Permalink to this headline">¶</a></h2>
<p>The extension ratio is a shape descriptor derived from the maximum distance of pixels to their object’s centroid divided by the average distance of pixels to the centroid. It alllows to differentiate elongated from roundish objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extension_ratio_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">extension_ratio_map</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">extension_ratio_map</span><span class="p">,</span> 
           <span class="n">color_map</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> 
           <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
           <span class="n">min_display_intensity</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> 
           <span class="n">max_display_intensity</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_19_0.png" src="../_images/parametric_maps_19_0.png" />
</div>
</div>
</div>
<div class="section" id="mean-minimum-maximum-standard-deviation-intensity-map">
<h2>Mean / minimum / maximum / standard-deviation intensity map<a class="headerlink" href="#mean-minimum-maximum-standard-deviation-intensity-map" title="Permalink to this headline">¶</a></h2>
<p>If we use additionally an intensity image, we can also produce parametric images showing intensity measurements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">blobs</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../../data/blobs.tif&#39;</span><span class="p">),</span> <span class="n">factor_x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">factor_y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">auto_size</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">blobs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_21_0.png" src="../_images/parametric_maps_21_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_intensity_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">label_mean_intensity_map</span><span class="p">(</span><span class="n">blobs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mean_intensity_map</span><span class="p">,</span> 
           <span class="n">color_map</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> 
           <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
           <span class="n">min_display_intensity</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> 
           <span class="n">max_display_intensity</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_22_0.png" src="../_images/parametric_maps_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maximum_intensity_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">maximum_intensity_map</span><span class="p">(</span><span class="n">blobs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">maximum_intensity_map</span><span class="p">,</span> 
           <span class="n">color_map</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> 
           <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
           <span class="n">min_display_intensity</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> 
           <span class="n">max_display_intensity</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_23_0.png" src="../_images/parametric_maps_23_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stddev_intensity_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">standard_deviation_intensity_map</span><span class="p">(</span><span class="n">blobs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stddev_intensity_map</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_24_0.png" src="../_images/parametric_maps_24_0.png" />
</div>
</div>
</div>
<div class="section" id="aspect-ratio-map">
<h2>Aspect ratio map<a class="headerlink" href="#aspect-ratio-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">aspect_ratio</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">statistics</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">minor_axis_length</span><span class="p">:</span>
        <span class="n">aspect_ratio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">major_axis_length</span> <span class="o">/</span> <span class="n">s</span><span class="o">.</span><span class="n">minor_axis_length</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">aspect_ratio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># note: an aspect ratio of 0 is an &quot;invalid&quot; value</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aspect_ratio_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">aspect_ratio</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aspect_ratio_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_27_0.png" src="../_images/parametric_maps_27_0.png" />
</div>
</div>
</div>
<div class="section" id="elongation-map">
<h2>Elongation map<a class="headerlink" href="#elongation-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">eccentricity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">eccentricity</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">statistics</span><span class="p">]</span>

<span class="n">eccentricity_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">eccentricity</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">eccentricity_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_29_0.png" src="../_images/parametric_maps_29_0.png" />
</div>
</div>
</div>
<div class="section" id="extent-map">
<h2>Extent map<a class="headerlink" href="#extent-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">extent</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">statistics</span><span class="p">]</span>

<span class="n">extent_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">extent</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">extent_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_31_0.png" src="../_images/parametric_maps_31_0.png" />
</div>
</div>
</div>
<div class="section" id="feret-diameter-map">
<h2>Feret diameter map<a class="headerlink" href="#feret-diameter-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">feret_diameter</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">feret_diameter_max</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">statistics</span><span class="p">]</span>

<span class="n">feret_diameter_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">feret_diameter</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">feret_diameter_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_33_0.png" src="../_images/parametric_maps_33_0.png" />
</div>
</div>
</div>
<div class="section" id="orientation-map">
<h2>Orientation map<a class="headerlink" href="#orientation-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">orientation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">orientation</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">statistics</span><span class="p">]</span>

<span class="n">orientation_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">orientation</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">orientation_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_35_0.png" src="../_images/parametric_maps_35_0.png" />
</div>
</div>
</div>
<div class="section" id="perimeter-map">
<h2>Perimeter map<a class="headerlink" href="#perimeter-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">perimeter_ski</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">perimeter</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">statistics</span><span class="p">]</span>

<span class="n">perimeter_ski_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">perimeter_ski</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">perimeter_ski_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_37_0.png" src="../_images/parametric_maps_37_0.png" />
</div>
</div>
</div>
<div class="section" id="solidity-map">
<h2>Solidity map<a class="headerlink" href="#solidity-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">solidity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">solidity</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">statistics</span><span class="p">]</span>

<span class="n">solidity_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">solidity</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">solidity_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_39_0.png" src="../_images/parametric_maps_39_0.png" />
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Elongation map<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">elongation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">statistics_sitk</span><span class="p">[</span><span class="s1">&#39;elongation&#39;</span><span class="p">]</span>

<span class="n">elongation_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">elongation</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">elongation_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_41_0.png" src="../_images/parametric_maps_41_0.png" />
</div>
</div>
</div>
<div class="section" id="flatness-map">
<h2>Flatness map<a class="headerlink" href="#flatness-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">flatness</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">statistics_sitk</span><span class="p">[</span><span class="s1">&#39;flatness&#39;</span><span class="p">]</span>

<span class="n">flatness_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">flatness</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">flatness_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_43_0.png" src="../_images/parametric_maps_43_0.png" />
</div>
</div>
</div>
<div class="section" id="roundness-map">
<h2>Roundness map<a class="headerlink" href="#roundness-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">roundness</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">statistics_sitk</span><span class="p">[</span><span class="s1">&#39;roundness&#39;</span><span class="p">]</span>

<span class="n">roundness_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">roundness</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">roundness_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_45_0.png" src="../_images/parametric_maps_45_0.png" />
</div>
</div>
</div>
<div class="section" id="id2">
<h2>Perimeter map<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">perimeter_sitk</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">statistics_sitk</span><span class="p">[</span><span class="s1">&#39;perimeter&#39;</span><span class="p">]</span>

<span class="n">perimeter_sitk_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">perimeter_sitk</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">perimeter_sitk_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_47_0.png" src="../_images/parametric_maps_47_0.png" />
</div>
</div>
</div>
<div class="section" id="quality-assurance">
<h2>Quality assurance<a class="headerlink" href="#quality-assurance" title="Permalink to this headline">¶</a></h2>
<p>If you generate a parametric image with the “label” column, the parametric image should actually be equal to the label input image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;re appending a [0] for the &quot;measurement&quot; of the background and attach all values behind</span>
<span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">statistics_sitk</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>

<span class="n">label_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">replace_intensities</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">label_map</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_49_0.png" src="../_images/parametric_maps_49_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">label_difference</span> <span class="o">=</span> <span class="n">labels</span> <span class="o">-</span> <span class="n">label_map</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">label_difference</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_50_0.png" src="../_images/parametric_maps_50_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">label_difference</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">label_difference</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 0.0)
</pre></div>
</div>
</div>
</div>
<p>When comparing perimeter measurements from scikit-image and SimpleITK, we could see small differences. Here we can visualize which objects are affected and to what degree.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perimeter_difference</span> <span class="o">=</span> <span class="n">perimeter_sitk_map</span> <span class="o">-</span> <span class="n">perimeter_ski_map</span>

<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">perimeter_difference</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parametric_maps_53_0.png" src="../_images/parametric_maps_53_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./60_data_visualization"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="overlay_text_on_image.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Overlay texts on images</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="quantitative_neighbor_maps.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Quantitative maps from neighbor statistics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Robert Haase, Miguel Fernandes, Marcelo Leomil Zoccoler & add-your-name-here-by-sending-a-pull-request-containing-a-notebook<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>